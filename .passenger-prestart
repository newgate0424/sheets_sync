#!/bin/bash

# Passenger pre-start hook
# This runs before Passenger starts the application

echo "==================================="
echo "Passenger Pre-Start Hook"
echo "==================================="

# Set environment
export NODE_ENV=production

# Check if .next exists
if [ ! -d ".next" ]; then
    echo "ERROR: .next directory not found!"
    echo "Running build..."
    npm run build || exit 1
fi

# Check if node_modules exists
if [ ! -d "node_modules" ]; then
    echo "ERROR: node_modules not found!"
    echo "Installing dependencies..."
    npm install --production || exit 1
fi

echo "Pre-start checks passed"
echo "==================================="

exit 0
